<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ page.title }} | {{ config.title | default(value="Clexp Explores Technology") }}</title>
    <meta name="description" content="{{ page.description | default(value=config.description) }}">
    
    <!-- CSS -->
    <link rel="stylesheet" href="{{ get_url(path="main.css") }}">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <header class="site-header">
        <div class="container">
            <nav class="nav">
                <div class="nav-brand">
                    <a href="{{ config.base_url }}">{{ config.title | default(value="Clexp Explores Technology") }}</a>
                </div>
                <div class="nav-menu">
                    <a href="{{ config.base_url }}" class="nav-link">Home</a>
                    <a href="{{ get_url(path="about") }}" class="nav-link">About</a>
                    <div class="search-container">
                        <input type="search" id="search" placeholder="Search posts..." class="search-input">
                        <div id="search-results" class="search-results hidden">
                            <div id="search-results-list" class="search-results-list"></div>
                        </div>
                    </div>
                </div>
            </nav>
        </div>
    </header>

    <main class="site-main">
        <div class="container">
            <article class="page-content">
                <h1>{{ page.title }}</h1>
                
                {% if page.taxonomies.tags %}
                <div class="post-meta">
                    <div class="post-tags">
                        {% for tag in page.taxonomies.tags %}
                        <span class="tag">{{ tag }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
                
                {{ page.content | safe }}
            </article>
        </div>
    </main>

    <footer class="site-footer">
        <div class="container">
            <p>&copy; {{ now() | date(format="%Y") }} {{ config.title | default(value="Clexp Explores Technology") }}. Built with <a href="https://www.getzola.org/">Zola</a>.</p>
        </div>
    </footer>

    <!-- Simple Working Zola Search -->
    <script src="{{ get_url(path="elasticlunr.min.js") }}"></script>
    <script src="{{ get_url(path="search_index.en.js") }}"></script>
    <script>
        (function() {
            'use strict';
            
            let searchIndex;
            
            document.addEventListener('DOMContentLoaded', function() {
                const searchInput = document.getElementById('search');
                const searchResults = document.getElementById('search-results');
                const searchResultsList = document.getElementById('search-results-list');
                
                if (!searchInput || !searchResults || !searchResultsList) {
                    console.warn('Search elements not found');
                    return;
                }
                
                // Initialize search index
                if (typeof window.searchIndex !== 'undefined') {
                    searchIndex = elasticlunr.Index.load(window.searchIndex);
                } else {
                    console.error('Search index not available');
                    return;
                }
                
                // Simple search function
                function performSearch(query) {
                    if (!query || query.length < 2) {
                        return [];
                    }
                    
                    try {
                        return searchIndex.search(query, {
                            fields: {
                                title: {boost: 2},
                                body: {boost: 1}
                            },
                            bool: "OR"
                        }).slice(0, 8); // Limit results
                    } catch (e) {
                        console.error('Search error:', e);
                        return [];
                    }
                }
                
                // Create clean title from URL
                function getTitle(url) {
                    const parts = url.split('/').filter(Boolean);
                    const slug = parts[parts.length - 1] || 'Home';
                    return slug.replace(/-/g, ' ')
                              .replace(/\b\w/g, l => l.toUpperCase());
                }
                
                // Display results in dropdown
                function displayResults(results) {
                    searchResultsList.innerHTML = '';
                    
                    if (results.length === 0) {
                        searchResultsList.innerHTML = '<div class="no-results">No results found</div>';
                        return;
                    }
                    
                    results.forEach(result => {
                        const item = document.createElement('div');
                        item.className = 'search-result-item';
                        
                        const title = getTitle(result.ref);
                        const url = result.ref;
                        
                        // Only show title, no URL
                        item.innerHTML = `<a href="${url}">${title}</a>`;
                        
                        searchResultsList.appendChild(item);
                    });
                }
                
                // Input event - show dropdown
                searchInput.addEventListener('input', function(e) {
                    const query = e.target.value.trim();
                    
                    if (query.length >= 2) {
                        const results = performSearch(query);
                        displayResults(results);
                        searchResults.classList.remove('hidden');
                    } else {
                        searchResults.classList.add('hidden');
                    }
                });
                
                // Enter key - go to first result
                searchInput.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' && e.target.value.trim().length >= 2) {
                        e.preventDefault();
                        const results = performSearch(e.target.value.trim());
                        if (results.length > 0) {
                            window.location.href = results[0].ref;
                        }
                    }
                    
                    if (e.key === 'Escape') {
                        searchResults.classList.add('hidden');
                        searchInput.blur();
                    }
                });
                
                // Hide on click outside
                document.addEventListener('click', function(e) {
                    if (!e.target.closest('.search-container')) {
                        searchResults.classList.add('hidden');
                    }
                });
                
                // Show on focus if there's content
                searchInput.addEventListener('focus', function() {
                    if (searchInput.value.trim().length >= 2) {
                        searchResults.classList.remove('hidden');
                    }
                });
            });
        })();
    </script>
</body>
</html> 